@page
@model MortgageCalculator.Pages.LoanModel
@{
}

@{
    ViewData["Title"] = "Mortgage Calculator Page";
}



<div class="container col-xxl-12 px-4 py-5 mt-2">
    <div class="row gy-2 h-100  row-cols-1">
        <div class="col">
            <h1 class="font-weight-bold lh-1 mb-3">Mortgage Calculator</h1>
            <h4 class="lead">
                This application will calculate the scheduled payments of a Loan. An amortizatin table will be created showing relavant details based on the information
                entered
            </h4>
            <h6 class="mt-2"> Mortgage Calculator - A simple way to calculate details of a loan </h6>
            <h2 class="mt-3">Instructions</h2>
            <hr />
            <p>Enter the requested info in the input fields.</p>
        </div>
    </div>



    <div class="row gy-2 h-100 row-cols-md-2 row-cols-sm-1 row-cols-1">
        <div class="col-6 p-5">
    
            <div>
                <form class="row gy-2 gx-3" method="post">
                    <div class="form-row">
                        <div class="col-12 form-group">
                            <label asp-for="Loan.LoanAmount">Property Price</label>
                            <input type="number" asp-for="Loan.LoanAmount" class="form-control" value="@Model.Loan.LoanAmount" placeholder="15000" min="1000" step="500" />
                        </div>
                        <div class="col-12 form-group">
                            <label asp-for="Loan.PayDown">Down Payment</label>
                            <input type="number" asp-for="Loan.PayDown" class="form-control" value="@Model.Loan.PayDown" placeholder="Pay Down" min="0" step="100" />
                        </div>
                        <div class="col-12 form-group">
                            <label asp-for="Loan.LoanTerm">Loan Term (months)</label>
                            <input type="number" asp-for="Loan.LoanTerm" class="form-control" value="@Model.Loan.LoanTerm" placeholder="Loan Term" min="12" />
                        </div>
                        <div class="col-12 form-group">
                            <label asp-for="Loan.LoanInterest">Loan Interest</label>
                            <input type="number" asp-for="Loan.LoanInterest" class="form-control" value="@Model.Loan.LoanInterest" placeholder="Loan Interest" min="1" step=".5" />
                        </div>
                       

                        @if (Model.Loan.PMIRequired == false)
                        {
                            <div class="col-12 form-group">
                                <label asp-for="Loan.PMIRate">PMI Rate</label>
                                <input type="number" asp-for="Loan.PMIRate" class="form-control" value="@Model.Loan.PMIRate" placeholder="PMI Rate" min="0" step=".1" max="2" />

                                <label asp-for="Loan.PMIRequired">PMI?</label>
                                <input type="checkbox" asp-for="Loan.PMIRequired" class="form-control" value="@Model.Loan.PMIRequired" />

                            </div>

                        }
                        else
                        {
                            <div class="col-12 form-group">
                                PMI Required
                                <label asp-for="Loan.PMIRate">PMI Rate</label>
                                <input type="number" asp-for="Loan.PMIRate" class="form-control" value="@Model.Loan.PMIRate" placeholder="PMI Rate" min="0.2" step=".1" max="2" />

                                <label asp-for="Loan.PMIRequired">PMI?</label>
                                <input type="checkbox" asp-for="Loan.PMIRequired" class="form-control" value="@Model.Loan.PMIRequired" checked/>

                            </div>
                        }


                        <button type="submit" class="btn btn-success btn-block mt-2">Calculate</button>
                    </div>

                </form>

            </div>
        </div>

        <div class="col-6 p-5">
            <div id="paymentTitle">
                <p class="mt-5 display-6">
                    Your Monthly Payments
                </p>
            </div>
            <p id="payment">@Model.Loan.Payment.ToString("C")</p>
            <div class="row loanForm mt-2">

                <div class="col-6">
                    <label class="text-start">PMI Required</label>
                </div>
                <div class="col-6">
                   
                    <label class="text-right">@Model.Loan.PMIRequired</label>
                </div>


                <div class="col-6">
                    <label class="text-start">PMI</label>
                </div>
                <div class="col-6">
                    <label class="text-right">@Model.Loan.PMIRate.ToString("C")</label>
                </div>

                <div class="col-6">
                    <label class="text-start">Down Payment</label>
                </div>
                <div class="col-6">
                    <label class="text-right">@Model.Loan.PayDown.ToString("C")</label>
                </div>




                <div class="col-6">
                    <label class="text-start">Total Principal</label>
                </div>
                <div class="col-6">
                    <label id="totalPrincipal" class="text-right">@Model.Loan.LoanAmount.ToString("C")</label>
                </div>

                <div class="col-6">
                    <label class="text-left">Total Interest</label>
                </div>
                <div class="col-6">
                    <label id="totalInterest" class="text-right">@Model.Loan.TotalInterest.ToString("C")</label>
                </div>

                <div class="col-6">
                    <label class="text-left mr-5 mt-1">Total Loan Cost</label>
                </div>
                <div class="col-6">
                    <h4>  <label id="totalCost" class="text-right"><span class="badge badge-success">@Model.Loan.TotalCost.ToString("C")</span></label></h4>
                </div>
            </div>
        </div>
    </div>

    <div class="=row">
        <div class="col">
            <h2 class="mt-3 text-center"> &#8595 &#8595 &#8595  Monthly Payments &#8595 &#8595 &#8595  </h2>

            @if (Model.Loan.Payments.Count > 0)
            {
                <div class="row table-responsive">
                    <div class="col">

                        <table id="scheduletable" class=" table table-striped table-hover ">
                            <thead class="text-black-50">
                                <tr>
                                    <th>Month</th>
                                    <th>Payment</th>
                                    <th>Principal</th>
                                    <th>Interest</th>
                                    <th>Total Interest</th>
                                    <th>Balance</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Loan.Payments)
                                {
                                    <tr>
                                        <td>
                                            @item.Month
                                        </td>
                                        <td>
                                            @item.Payment.ToString("C")
                                        </td>
                                        <td>
                                            @item.MonthlyPrincipal.ToString("C")
                                        </td>
                                        <td>
                                            @item.MonthlyInterest.ToString("C")
                                        </td>
                                        <td>
                                            @item.TotalInterest.ToString("C")
                                        </td>
                                        <td>
                                            @item.Balance.ToString("C")
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>

            }

        </div>
    </div>


</div>
